---
title: ktpass
description: Windows-Befehle Thema ****-
ms.prod: windows-server
ms.technology: manage-windows-commands
ms.topic: article
ms.assetid: 47087676-311e-41f1-8414-199740d01444
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: de74d04ceaca0147b4d12cd9c0eaacbf233e2fd7
ms.sourcegitcommit: b00d7c8968c4adc8f699dbee694afe6ed36bc9de
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/08/2020
ms.locfileid: "80841213"
---
# <a name="ktpass"></a>ktpass

>Gilt für: Windows Server (Semi-Annual Channel), Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

Konfiguriert den Server Prinzipal Namen für den Host oder Dienst in den Active Directory-Domänen Diensten (AD DS) und generiert eine keytab-Datei, die den gemeinsamen geheimen Schlüssel des Diensts enthält. Die KEYTAB-Datei basiert auf der Massachusetts Institute of Technology (MIT)-Implementierung des Kerberos-Authentifizierungsprotokolls. Mit dem Befehlszeilenprogramm "ktpass" können nicht-Windows-Dienste, die die Kerberos-Authentifizierung unterstützen, die vom Kerberos-Schlüsselverteilungscenter (KDC) bereitgestellten Interoperabilitäts Funktionen verwenden. Dieses Thema gilt für die Betriebssystemversionen, die in der Liste **gilt für** am Anfang des Themas angegeben sind.  

## <a name="syntax"></a>Syntax  
```  
ktpass  
[/out <FileName>]   
[/princ <PrincipalName>]   
[/mapuser <UserAccount>]   
[/mapop {add|set}] [{-|+}desonly] [/in <FileName>]  
[/pass {Password|*|{-|+}rndpass}]  
[/minpass]  
[/maxpass]  
[/crypto {DES-CBC-CRC|DES-CBC-MD5|RC4-HMAC-NT|AES256-SHA1|AES128-SHA1|All}]  
[/itercount]  
[/ptype {KRB5_NT_PRINCIPAL|KRB5_NT_SRV_INST|KRB5_NT_SRV_HST}]  
[/kvno <KeyversionNum>]  
[/answer {-|+}]  
[/target]  
[/rawsalt] [{-|+}dumpsalt] [{-|+}setupn] [{-|+}setpass <Password>]  [/?|/h|/help]  
```  
### <a name="parameters"></a>Parameter  

|                                             Parameter                                              |                                                                                                                                                                                                                                                                                                      Beschreibung                                                                                                                                                                                                                                                                                                       |
|----------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                          /Out <FileName>                                           |                                                                                                                                                                        Gibt den Namen der zu generierenden Datei "Kerberos 5. keytab" an. **Hinweis:** Dies ist die Datei ". keytab", die Sie auf einen Computer übertragen, auf dem das Windows-Betriebssystem nicht ausgeführt wird, und dann ersetzen oder Zusammenführen mit der vorhandenen Keytab-Datei,/etc/krb5.keytab.                                                                                                                                                                        |
|                                       /Princ <PrincipalName>                                       |                                                                                                                                                                                                                   Gibt den Prinzipal Namen im Formular host/computer.contoso.com@CONTOSO.COMan. **Warnung:** Bei diesem Parameter wird Groß-/Kleinschreibung beachtet Weitere Informationen finden Sie unter " [Hinweise](#BKMK_remarks) ".                                                                                                                                                                                                                    |
|                                       /mapuser <UserAccount>                                       |                                                                                                                                                                                                                                                Ordnet den Namen des Kerberos-Prinzipals, der vom **princ** -Parameter angegeben wird, dem angegebenen Domänen Konto zu.                                                                                                                                                                                                                                                |
|                                       /mapop {Add&#124;Set}                                        |                                                                                                                                                                             Gibt an, wie das Mapping-Attribut festgelegt wird.<p>durch -   **Hinzufügen** wird der Wert des angegebenen lokalen Benutzernamens hinzugefügt. Dies ist der Standardwert.<br />-   **Satz** legt den Wert für die Verschlüsselung von Daten Verschlüsselungs Standard (des) nur für den angegebenen lokalen Benutzernamen fest.                                                                                                                                                                             |
|                                         {-&#124;+} nicht ordnungsgemäß                                          |                                                                                                                                                            Die nur-der-Verschlüsselung wird standardmäßig festgelegt.<p>-    **+** ein Konto für die reine des-Verschlüsselung festlegt.<br />-    **-** Freigabe Einschränkung für ein Konto für die reine des-Verschlüsselung. **Wichtig:** Ab Windows 7 und Windows Server 2008 R2 unterstützt Windows nicht standardmäßig.                                                                                                                                                            |
|                                           /in <FileName>                                           |                                                                                                                                                                                                                                                       Gibt die Keytab-Datei an, die von einem Host Computer gelesen werden soll, auf dem das Windows-Betriebssystem nicht ausgeführt wird.                                                                                                                                                                                                                                                        |
|                          /Pass {password&#124;\*&#124;{-&#124;+} rndpass}                           |                                                                                                                                                                                                                                           Gibt ein Kennwort für den Prinzipal Benutzernamen an, der durch den **princ** -Parameter angegeben wird. Verwenden Sie \*, um ein Kennwort einzugeben.                                                                                                                                                                                                                                            |
|                                              /minpass                                              |                                                                                                                                                                                                                                                                            Legt die minimale Länge des Zufalls Kennworts auf 15 Zeichen fest.                                                                                                                                                                                                                                                                            |
|                                              /maxpass                                              |                                                                                                                                                                                                                                                                           Legt die maximale Länge des Zufalls Kennworts auf 256 Zeichen fest.                                                                                                                                                                                                                                                                            |
| /Crypto {des-CBC-CRC&#124;des-CBC-MD5&#124;RC4-HMAC-NT&#124;AES256-SHA1&#124;AES128-SHA1&#124;all} | Gibt die Schlüssel an, die in der Schlüssel Tabellendatei-Datei generiert werden:<p>-   **des-CBC-CRC** wird aus Gründen der Kompatibilität verwendet.<br />-   **des-CBC-MD5** hält die mit-Implementierung genauer an und wird aus Kompatibilitätsgründen verwendet.<br />-   **RC4-HMAC-NT** verwendet 128-Bit-Verschlüsselung.<br />-   **AES256-SHA1** verwendet die Verschlüsselung AES256-CTS-HMAC-SHA1-96.<br />-   **AES128-SHA1** verwendet die Verschlüsselung AES128-CTS-HMAC-SHA1-96.<br />-   **alle** Zustände, die alle unterstützten kryptografietypen verwenden können. **Hinweis:** Die Standardeinstellungen basieren auf älteren mit-Versionen. Daher sollten `/crypto` immer angegeben werden. |
|                                             /itercount                                             |                                                                                                                                                                                                                        Gibt die Anzahl der Iterationen an, die für die AES-Verschlüsselung verwendet wird. Der Standardwert ist, dass **itercount** bei der nicht-AES-Verschlüsselung ignoriert und bei der AES-Verschlüsselung bei 4.096 festgelegt wird.                                                                                                                                                                                                                         |
|               /pType {KRB5_NT_PRINCIPAL&#124;KRB5_NT_SRV_INST&#124;KRB5_NT_SRV_HST}                |                                                                                                                                                                                         Gibt den Prinzipaltyp an.<p>-   **KRB5_NT_PRINCIPAL** ist der allgemeine Prinzipaltyp (empfohlen).<br />-   **KRB5_NT_SRV_INST** ist die Instanz des Benutzer Dienstanbieter.<br />-   **KRB5_NT_SRV_HST** ist die Host Dienst Instanz.                                                                                                                                                                                         |
|                                       /kvno <KeyversionNum>                                        |                                                                                                                                                                                                                                                                               Gibt die Versionsnummer des Schlüssels an. Der Standardwert lautet 1.                                                                                                                                                                                                                                                                                |
|                                         /Answer {-&#124;+}                                         |                                                                                                                                                                                                                    Legt den Hintergrund Antwortmodus fest:<p>**-** Antworten auf Kenn Wort Zurücksetzungen automatisch zurücksetzen, ohne.<p>**+** Antworten Zurücksetzen von Kenn Wort Eingabe Aufforderungen mit Ja.                                                                                                                                                                                                                     |
|                                              /target                                               |                                                                                                                                                                                           Legt fest, welcher Domänen Controller verwendet werden soll. Standardmäßig wird der Domänen Controller basierend auf dem Prinzipal Namen erkannt. Wenn der Domänen Controller Name nicht aufgelöst wird, werden Sie in einem Dialogfeld zur Eingabe eines gültigen Domänen Controllers aufgefordert.                                                                                                                                                                                           |
|                                              /rawsalt                                              |                                                                                                                                                                                                                                                           erzwingt, dass "ktpass" den rawsalt-Algorithmus beim Erzeugen des Schlüssels verwendet. Dieser Parameter ist nicht erforderlich.                                                                                                                                                                                                                                                            |
|                                         {-&#124;+} dumpsalt                                         |                                                                                                                                                                                                                                                           Die Ausgabe dieses Parameters zeigt den mit Salt-Algorithmus, der verwendet wird, um den Schlüssel zu generieren.                                                                                                                                                                                                                                                            |
|                                          {-&#124;+} setupn                                          |                                                                                                                                                                                                                                          Legt den Benutzer Prinzipal Namen (User Principal Name, UPN) zusätzlich zum Dienst Prinzipal Namen (SPN) fest. Standardmäßig wird beide in der Keytab-Datei festgelegt.                                                                                                                                                                                                                                           |
|                                    {-&#124;+} SETPASS-<Password>                                    |                                                                                                                                                                                                                                                          Legt das Kennwort des Benutzers fest, wenn angegeben. Wenn rndpass verwendet wird, wird stattdessen ein zufälliges Kennwort generiert.                                                                                                                                                                                                                                                           |
|                                       /? &#124;/h&#124;/Help                                        |                                                                                                                                                                                                                                                                                         Zeigt die Befehlszeilen Hilfe für "ktpass" an.                                                                                                                                                                                                                                                                                         |

## <a name="remarks"></a><a name=BKMK_remarks></a>Rede  
Dienste, die auf Systemen ausgeführt werden, auf denen das Windows-Betriebssystem nicht ausgeführt wird, können mit Dienst Instanzen Konten in den Active Directory-Domänen Diensten konfiguriert werden Dadurch kann sich jeder Kerberos-Client bei Diensten authentifizieren, auf denen das Windows-Betriebssystem nicht mithilfe von Windows-KDCs ausgeführt wird.  
Der/princ-Parameter wird nicht von "ktpass" ausgewertet und wie angegeben verwendet. Es wird nicht überprüft, ob der Parameter mit dem Wert des **userPrincipalName** -Attributs bei der Erstellung der Keytab-Datei übereinstimmt. Die Groß-/Kleinschreibung von Kerberos-Distributionen, die diese Keytab-Datei verwenden, treten möglicherweise Probleme auf, wenn keine exakte Groß-/Kleinschreibung vorliegt und bei der Überprüfen Sie den korrekten **userPrincipalName** -Attribut Wert aus einer LDIFDE-Exportdatei, und rufen Sie ihn ab. Beispiel:  
```  
ldifde /f keytab_user.ldf /d CN=Keytab User,OU=UserAccounts,DC=contoso,DC=corp,DC=microsoft,DC=com /p base /l samaccountname,userprincipalname  
```  
## <a name="examples"></a><a name=BKMK_examples></a>Beispiele  
Im folgenden Beispiel wird veranschaulicht, wie eine Kerberos. keytab-Datei (Machine. keytab) im aktuellen Verzeichnis für den Benutzer sample1 erstellt wird. (Sie werden diese Datei mit der Datei krb5. keytab auf einem Host Computer zusammenführen, auf dem das Windows-Betriebssystem nicht ausgeführt wird.) Die Datei "Kerberos. keytab" wird für alle unterstützten Verschlüsselungstypen für den Typ "allgemeiner Prinzipal" erstellt.  
Um eine keytab-Datei für einen Host Computer zu generieren, auf dem das Windows-Betriebssystem nicht ausgeführt wird, führen Sie die folgenden Schritte aus, um den Prinzipal dem Konto zuzuordnen und das Host Prinzipal Kennwort festzulegen:  
1.  Verwenden Sie das Snap-in Active Directory-Benutzer und-Computer, um ein Benutzerkonto für einen Dienst auf einem Computer zu erstellen, auf dem das Windows-Betriebssystem nicht ausgeführt wird. Erstellen Sie z. b. ein Konto mit dem Namen sample1.  
2.  Richten Sie mithilfe von "ktpass" eine Identitäts Zuordnung für das Benutzerkonto ein, indem Sie Folgendes an einer Eingabeaufforderung eingeben:  
    ```  
    ktpass /princ host/Sample1.contoso.com@CONTOSO.COM /mapuser Sample1 /pass MyPas$w0rd /out Sample1.keytab /crypto all /ptype KRB5_NT_PRINCIPAL /mapop set   
    ```  

    > [!NOTE]  
    > Sie können nicht mehrere Dienst Instanzen demselben Benutzerkonto zuordnen.  

3.  Führen Sie die Datei ". keytab" mit der Datei "/etc/krb5.keytab" auf einem Host Computer zusammen, auf dem das Windows-Betriebssystem nicht ausgeführt wird. 

## <a name="additional-references"></a>Weitere Verweise  
- [Erläuterung zur Befehlszeilensyntax](command-line-syntax-key.md)  
